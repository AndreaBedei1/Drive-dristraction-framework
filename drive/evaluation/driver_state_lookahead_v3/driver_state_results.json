{
  "constraints": {
    "driver_state_only": true,
    "excluded_sources": [
      "speed_kmh",
      "steer_angle_deg",
      "map_name",
      "weather",
      "frame",
      "sim_time_seconds",
      "x/y/z position",
      "road_id",
      "lane_id"
    ],
    "leakage_controls": [
      "user-level train/cal/test split",
      "train-only imputation",
      "train-only encoders",
      "train-only feature clipping",
      "H/T search on train only",
      "calibration + threshold on calibration only",
      "single locked test evaluation"
    ]
  },
  "device": {
    "xgb_requested": "auto",
    "xgb_resolved": "cuda",
    "xgb_n_jobs": 1
  },
  "users": {
    "train": [
      "participant_17",
      "participant_06",
      "participant_14",
      "participant_12",
      "participant_23",
      "participant_02",
      "participant_03",
      "participant_26",
      "participant_04",
      "participant_22",
      "participant_27",
      "participant_19",
      "participant_30",
      "participant_21",
      "participant_08",
      "participant_11",
      "participant_15",
      "participant_20",
      "participant_07"
    ],
    "cal": [
      "participant_29",
      "participant_25",
      "participant_13",
      "participant_01",
      "participant_05"
    ],
    "test": [
      "participant_28",
      "participant_16",
      "participant_24",
      "participant_18",
      "participant_09",
      "participant_10"
    ]
  },
  "best_config": {
    "H": 4,
    "T": 4
  },
  "best_model": {
    "name": "blend_calibrated",
    "calibration": "weighted_average",
    "threshold_f1_on_cal": 0.18027604847668838,
    "kind": "blend",
    "blend_weights": {
      "xgb_tuned": 0.25,
      "logreg_tuned": 0.4,
      "hgb_tuned": 0.35
    }
  },
  "model_selection_on_cal": [
    {
      "model": "xgb_tuned",
      "calibration": "isotonic",
      "ap_cal": 0.3085651733398983,
      "brier_cal": 0.15563999385616295
    },
    {
      "model": "logreg_tuned",
      "calibration": "sigmoid",
      "ap_cal": 0.3105994469185668,
      "brier_cal": 0.15547062688151644
    },
    {
      "model": "hgb_tuned",
      "calibration": "isotonic",
      "ap_cal": 0.3114656476409325,
      "brier_cal": 0.15389663395246272
    },
    {
      "model": "blend_calibrated",
      "calibration": "weighted_average",
      "ap_cal": 0.33207156847102925,
      "brier_cal": 0.15416419342521054,
      "weights": {
        "xgb_tuned": 0.25,
        "logreg_tuned": 0.4,
        "hgb_tuned": 0.35
      }
    }
  ],
  "samples": {
    "train": 17244,
    "cal": 4174,
    "test": 5416
  },
  "positive_rate": {
    "train": 0.26554163767107397,
    "cal": 0.20627695256348827,
    "test": 0.27307976366322007
  },
  "metrics_test": {
    "AUC-PR": 0.4736979247160862,
    "AUC-ROC": 0.7351252133200683,
    "Brier": 0.1801711974556126,
    "LogLoss": 0.536465730165943,
    "F1": 0.5293192541002022,
    "Precision": 0.39636608344549124,
    "Recall": 0.7964841108857336,
    "MCC": 0.30514099054607796,
    "Kappa": 0.2591450196664281,
    "Precision@Recall>=0.80": 0.39206611570247935,
    "Precision@Recall>=0.85": 0.35762904140669316,
    "Precision@Recall>=0.90": 0.32432432432432434,
    "Precision@Recall>=0.95": 0.3004273504273504
  },
  "ci_test": {
    "AUC-PR": {
      "mean": 0.47567585205498863,
      "low": 0.4525582497936019,
      "high": 0.5045854141876213
    },
    "AUC-ROC": {
      "mean": 0.7373654948573634,
      "low": 0.7212620214064439,
      "high": 0.7504241416747603
    },
    "Brier": {
      "mean": 0.17988789882934922,
      "low": 0.17415671226421373,
      "high": 0.1849335696870221
    }
  },
  "search_results": [
    {
      "H": 4,
      "T": 4,
      "ap_mean": 0.43516369158023427,
      "ap_std": 0.058125326483393844,
      "brier_mean": 0.21616029594815045,
      "n": 17244
    }
  ],
  "feature_cols": [
    "time_in_distraction",
    "time_since_distraction_end",
    "within_distraction",
    "hangover_decay",
    "window_progress",
    "window_duration",
    "prev_window_duration",
    "model_prob",
    "model_prob_sq",
    "model_prob_slope_decay",
    "model_pred_enc",
    "emotion_prob",
    "emotion_prob_sq",
    "emotion_prob_slope_decay",
    "emotion_label_enc",
    "arousal",
    "arousal_sq",
    "arousal_delta_baseline",
    "arousal_delta_sq",
    "arousal_slope_decay",
    "hr_bpm",
    "hr_delta_baseline",
    "hr_delta_sq",
    "hr_slope_decay",
    "dist_density_30",
    "dist_density_60",
    "dist_density_120",
    "sensor_missing_flag",
    "baseline_error_rate",
    "model_prob_ema5",
    "model_prob_ema15",
    "emotion_prob_ema5",
    "emotion_prob_ema15",
    "arousal_ema5",
    "arousal_ema15",
    "hr_bpm_ema5",
    "hr_bpm_ema15",
    "model_prob_dev_ema5",
    "model_prob_dev_ema15",
    "emotion_prob_dev_ema5",
    "emotion_prob_dev_ema15",
    "arousal_dev_ema5",
    "arousal_dev_ema15",
    "hr_bpm_dev_ema5",
    "hr_bpm_dev_ema15",
    "model_prob_diff1",
    "emotion_prob_diff1",
    "arousal_diff1",
    "hr_bpm_diff1",
    "model_prob_diff1_abs",
    "emotion_prob_diff1_abs",
    "arousal_diff1_abs",
    "hr_bpm_diff1_abs",
    "model_prob_roll_std5",
    "model_prob_roll_std15",
    "emotion_prob_roll_std5",
    "emotion_prob_roll_std15",
    "arousal_roll_std5",
    "arousal_roll_std15",
    "hr_bpm_roll_std5",
    "hr_bpm_roll_std15",
    "model_prob_roll_range5",
    "model_prob_roll_range15",
    "emotion_prob_roll_range5",
    "emotion_prob_roll_range15",
    "arousal_roll_range5",
    "arousal_roll_range15",
    "hr_bpm_roll_range5",
    "hr_bpm_roll_range15",
    "state_energy",
    "state_imbalance",
    "model_emotion_gap_abs",
    "model_emotion_product",
    "arousal_hr_coupling",
    "model_arousal_coupling",
    "emotion_hr_coupling",
    "cum_model_prob_mean",
    "cum_emotion_prob_mean",
    "cum_state_load_mean",
    "model_prob_drawdown",
    "emotion_prob_drawdown",
    "arousal_drawdown",
    "hr_drawdown",
    "signal_diff_abs_energy",
    "signal_roll_std_energy"
  ]
}