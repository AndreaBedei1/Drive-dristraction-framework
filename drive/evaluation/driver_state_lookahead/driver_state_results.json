{
  "constraints": {
    "driver_state_only": true,
    "excluded_sources": [
      "speed_kmh",
      "steer_angle_deg",
      "map_name",
      "weather",
      "frame",
      "sim_time_seconds",
      "x/y/z position",
      "road_id",
      "lane_id"
    ],
    "leakage_controls": [
      "user-level train/cal/test split",
      "train-only imputation",
      "train-only encoders",
      "train-only feature clipping",
      "H/T search on train only",
      "calibration + threshold on calibration only",
      "single locked test evaluation"
    ]
  },
  "device": {
    "xgb_requested": "auto",
    "xgb_resolved": "cuda",
    "xgb_n_jobs": 1
  },
  "users": {
    "train": [
      "participant_17",
      "participant_06",
      "participant_14",
      "participant_12",
      "participant_23",
      "participant_02",
      "participant_03",
      "participant_26",
      "participant_04",
      "participant_22",
      "participant_27",
      "participant_19",
      "participant_30",
      "participant_21",
      "participant_08",
      "participant_11",
      "participant_15",
      "participant_20",
      "participant_07"
    ],
    "cal": [
      "participant_29",
      "participant_25",
      "participant_13",
      "participant_01",
      "participant_05"
    ],
    "test": [
      "participant_28",
      "participant_16",
      "participant_24",
      "participant_18",
      "participant_09",
      "participant_10"
    ]
  },
  "best_config": {
    "H": 4,
    "T": 4
  },
  "best_model": {
    "name": "xgb_tuned",
    "calibration": "isotonic",
    "threshold_f1_on_cal": 0.20216049253940582
  },
  "model_selection_on_cal": [
    {
      "model": "xgb_tuned",
      "calibration": "isotonic",
      "ap_cal": 0.2955480182860166,
      "brier_cal": 0.15527016383967604
    },
    {
      "model": "logreg_tuned",
      "calibration": "isotonic",
      "ap_cal": 0.2947949411409629,
      "brier_cal": 0.15505562087558653
    }
  ],
  "samples": {
    "train": 17244,
    "cal": 4174,
    "test": 5416
  },
  "positive_rate": {
    "train": 0.26554163767107397,
    "cal": 0.20627695256348827,
    "test": 0.27307976366322007
  },
  "metrics_test": {
    "AUC-PR": 0.46114898468438376,
    "AUC-ROC": 0.7261353298906732,
    "Brier": 0.18233410067067787,
    "LogLoss": 0.5791570594673429,
    "F1": 0.5067539909946787,
    "Precision": 0.36336953331376576,
    "Recall": 0.837052062204192,
    "MCC": 0.2639043231863406,
    "Kappa": 0.2033675380706479,
    "Precision@Recall>=0.80": 0.36336953331376576,
    "Precision@Recall>=0.85": 0.34615384615384615,
    "Precision@Recall>=0.90": 0.3216698841698842,
    "Precision@Recall>=0.95": 0.2879644588045234
  },
  "ci_test": {
    "AUC-PR": {
      "mean": 0.46151999261014603,
      "low": 0.43996677715659843,
      "high": 0.4874324240854087
    },
    "AUC-ROC": {
      "mean": 0.7263242219825713,
      "low": 0.7104648796389297,
      "high": 0.7413064345091132
    },
    "Brier": {
      "mean": 0.18224277799767155,
      "low": 0.17628729257865508,
      "high": 0.18800647040294366
    }
  },
  "search_results": [
    {
      "H": 4,
      "T": 1,
      "ap_mean": 0.15109863566268789,
      "ap_std": 0.0326212778944011,
      "brier_mean": 0.20966524237212722,
      "n": 17244
    },
    {
      "H": 4,
      "T": 2,
      "ap_mean": 0.2719538626976106,
      "ap_std": 0.04374371032472656,
      "brier_mean": 0.21658465263255397,
      "n": 17244
    },
    {
      "H": 4,
      "T": 3,
      "ap_mean": 0.37104089805636453,
      "ap_std": 0.0487565336448783,
      "brier_mean": 0.21512556046161083,
      "n": 17244
    },
    {
      "H": 4,
      "T": 4,
      "ap_mean": 0.44082679406278613,
      "ap_std": 0.04920024721541268,
      "brier_mean": 0.214433122509552,
      "n": 17244
    },
    {
      "H": 4,
      "T": 5,
      "ap_mean": 0.49017079715802936,
      "ap_std": 0.05012619950451905,
      "brier_mean": 0.21662115672679305,
      "n": 17244
    },
    {
      "H": 6,
      "T": 1,
      "ap_mean": 0.1449160606190345,
      "ap_std": 0.025196315829959074,
      "brier_mean": 0.2038673741546132,
      "n": 21262
    },
    {
      "H": 6,
      "T": 2,
      "ap_mean": 0.27010111270919146,
      "ap_std": 0.04669916109619917,
      "brier_mean": 0.20964043527354168,
      "n": 21262
    },
    {
      "H": 6,
      "T": 3,
      "ap_mean": 0.36160391361116595,
      "ap_std": 0.05442538403398404,
      "brier_mean": 0.21071397619885696,
      "n": 21262
    },
    {
      "H": 6,
      "T": 4,
      "ap_mean": 0.425861090089113,
      "ap_std": 0.05482388758407008,
      "brier_mean": 0.21241747361815216,
      "n": 21262
    },
    {
      "H": 6,
      "T": 5,
      "ap_mean": 0.46706564355999075,
      "ap_std": 0.04902619865909341,
      "brier_mean": 0.21706554184571164,
      "n": 21262
    },
    {
      "H": 8,
      "T": 1,
      "ap_mean": 0.14908613802318404,
      "ap_std": 0.02116488967071089,
      "brier_mean": 0.19843536334782547,
      "n": 24704
    },
    {
      "H": 8,
      "T": 2,
      "ap_mean": 0.26761386970435685,
      "ap_std": 0.032188806310605514,
      "brier_mean": 0.20593415080448269,
      "n": 24704
    },
    {
      "H": 8,
      "T": 3,
      "ap_mean": 0.3569426764614098,
      "ap_std": 0.042680370420862514,
      "brier_mean": 0.20829228198215458,
      "n": 24704
    },
    {
      "H": 8,
      "T": 4,
      "ap_mean": 0.41502802606004957,
      "ap_std": 0.04281927741024987,
      "brier_mean": 0.2124854289201433,
      "n": 24704
    },
    {
      "H": 8,
      "T": 5,
      "ap_mean": 0.4529655239927295,
      "ap_std": 0.040561869992813616,
      "brier_mean": 0.21757997373813545,
      "n": 24704
    },
    {
      "H": 10,
      "T": 1,
      "ap_mean": 0.14281121410658398,
      "ap_std": 0.022013118730926592,
      "brier_mean": 0.1944823662721688,
      "n": 27681
    },
    {
      "H": 10,
      "T": 2,
      "ap_mean": 0.2524237065702544,
      "ap_std": 0.03571715273443984,
      "brier_mean": 0.20441232795028835,
      "n": 27681
    },
    {
      "H": 10,
      "T": 3,
      "ap_mean": 0.3352751617722636,
      "ap_std": 0.047658567478136245,
      "brier_mean": 0.20804239969823446,
      "n": 27681
    },
    {
      "H": 10,
      "T": 4,
      "ap_mean": 0.38897807378116583,
      "ap_std": 0.0464707689603678,
      "brier_mean": 0.21427933942106742,
      "n": 27681
    },
    {
      "H": 10,
      "T": 5,
      "ap_mean": 0.4279272270399573,
      "ap_std": 0.043208425803255665,
      "brier_mean": 0.22082164668268398,
      "n": 27681
    },
    {
      "H": 12,
      "T": 1,
      "ap_mean": 0.1415893710450654,
      "ap_std": 0.015781792379371908,
      "brier_mean": 0.1916333940429248,
      "n": 30182
    },
    {
      "H": 12,
      "T": 2,
      "ap_mean": 0.25133648161698163,
      "ap_std": 0.03269525605047229,
      "brier_mean": 0.20061945949407195,
      "n": 30182
    },
    {
      "H": 12,
      "T": 3,
      "ap_mean": 0.337002451480541,
      "ap_std": 0.032576479637692425,
      "brier_mean": 0.20691179083915384,
      "n": 30182
    },
    {
      "H": 12,
      "T": 4,
      "ap_mean": 0.38953949642226793,
      "ap_std": 0.034058832820995165,
      "brier_mean": 0.21453334810646038,
      "n": 30182
    },
    {
      "H": 12,
      "T": 5,
      "ap_mean": 0.42827091442635956,
      "ap_std": 0.03162061780878906,
      "brier_mean": 0.22204847733209776,
      "n": 30182
    },
    {
      "H": 15,
      "T": 1,
      "ap_mean": 0.13949662240364202,
      "ap_std": 0.01880319000648349,
      "brier_mean": 0.18970257788035297,
      "n": 32989
    },
    {
      "H": 15,
      "T": 2,
      "ap_mean": 0.2423485454662103,
      "ap_std": 0.03093974507288745,
      "brier_mean": 0.1988886564425349,
      "n": 32989
    },
    {
      "H": 15,
      "T": 3,
      "ap_mean": 0.32418588501969725,
      "ap_std": 0.04049409288626875,
      "brier_mean": 0.20768253229024358,
      "n": 32989
    },
    {
      "H": 15,
      "T": 4,
      "ap_mean": 0.37805597047575257,
      "ap_std": 0.041842449791992996,
      "brier_mean": 0.21565073752617636,
      "n": 32989
    },
    {
      "H": 15,
      "T": 5,
      "ap_mean": 0.4156608079168932,
      "ap_std": 0.042154678641900145,
      "brier_mean": 0.22392474583152705,
      "n": 32989
    },
    {
      "H": 18,
      "T": 1,
      "ap_mean": 0.14054710651050398,
      "ap_std": 0.022747942635517313,
      "brier_mean": 0.1886399859433029,
      "n": 34758
    },
    {
      "H": 18,
      "T": 2,
      "ap_mean": 0.24305827834448102,
      "ap_std": 0.036247861595849085,
      "brier_mean": 0.2005919700149942,
      "n": 34758
    },
    {
      "H": 18,
      "T": 3,
      "ap_mean": 0.31930161121404876,
      "ap_std": 0.04029465899980249,
      "brier_mean": 0.21158583950471457,
      "n": 34758
    },
    {
      "H": 18,
      "T": 4,
      "ap_mean": 0.37196565038443097,
      "ap_std": 0.041929074950613626,
      "brier_mean": 0.22006613569815964,
      "n": 34758
    },
    {
      "H": 18,
      "T": 5,
      "ap_mean": 0.41286102862094914,
      "ap_std": 0.04514278549515384,
      "brier_mean": 0.22742213673489625,
      "n": 34758
    }
  ],
  "feature_cols": [
    "time_in_distraction",
    "time_since_distraction_end",
    "within_distraction",
    "hangover_decay",
    "window_progress",
    "window_duration",
    "prev_window_duration",
    "model_prob",
    "model_prob_sq",
    "model_prob_slope_decay",
    "model_pred_enc",
    "emotion_prob",
    "emotion_prob_sq",
    "emotion_prob_slope_decay",
    "emotion_label_enc",
    "arousal",
    "arousal_sq",
    "arousal_delta_baseline",
    "arousal_delta_sq",
    "arousal_slope_decay",
    "hr_bpm",
    "hr_delta_baseline",
    "hr_delta_sq",
    "hr_slope_decay",
    "dist_density_30",
    "dist_density_60",
    "dist_density_120",
    "sensor_missing_flag",
    "baseline_error_rate"
  ]
}