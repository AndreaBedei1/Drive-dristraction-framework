{
  "constraints": {
    "driver_state_only": true,
    "excluded_sources": [
      "speed_kmh",
      "steer_angle_deg",
      "map_name",
      "weather",
      "frame",
      "sim_time_seconds",
      "x/y/z position",
      "road_id",
      "lane_id"
    ],
    "leakage_controls": [
      "user-level train/cal/test split",
      "train-only imputation",
      "train-only encoders",
      "train-only feature clipping",
      "H/T search on train only",
      "calibration + threshold on calibration only",
      "single locked test evaluation"
    ]
  },
  "device": {
    "xgb_requested": "auto",
    "xgb_resolved": "cuda",
    "xgb_n_jobs": 1
  },
  "users": {
    "train": [
      "participant_17",
      "participant_06",
      "participant_14",
      "participant_12",
      "participant_23",
      "participant_02",
      "participant_03",
      "participant_26",
      "participant_04",
      "participant_22",
      "participant_27",
      "participant_19",
      "participant_30",
      "participant_21",
      "participant_08",
      "participant_11",
      "participant_15",
      "participant_20",
      "participant_07"
    ],
    "cal": [
      "participant_29",
      "participant_25",
      "participant_13",
      "participant_01",
      "participant_05"
    ],
    "test": [
      "participant_28",
      "participant_16",
      "participant_24",
      "participant_18",
      "participant_09",
      "participant_10"
    ]
  },
  "best_config": {
    "H": 15,
    "T": 4
  },
  "best_model": {
    "name": "blend_calibrated",
    "calibration": "weighted_average",
    "threshold_f1_on_cal": 0.20255606953505859,
    "kind": "blend",
    "blend_weights": {
      "xgb_tuned": 0.25,
      "logreg_tuned": 0.0,
      "hgb_tuned": 0.75
    }
  },
  "model_selection_on_cal": [
    {
      "model": "xgb_tuned",
      "calibration": "isotonic",
      "ap_cal": 0.27736551186792957,
      "brier_cal": 0.12690504215669576
    },
    {
      "model": "logreg_tuned",
      "calibration": "isotonic",
      "ap_cal": 0.2261943420588768,
      "brier_cal": 0.13143863827720095
    },
    {
      "model": "hgb_tuned",
      "calibration": "sigmoid",
      "ap_cal": 0.2836482901449847,
      "brier_cal": 0.12860398289012262
    },
    {
      "model": "blend_calibrated",
      "calibration": "weighted_average",
      "ap_cal": 0.2869257597503923,
      "brier_cal": 0.12799098669269093,
      "weights": {
        "xgb_tuned": 0.25,
        "logreg_tuned": 0.0,
        "hgb_tuned": 0.75
      }
    }
  ],
  "samples": {
    "train": 32989,
    "cal": 8213,
    "test": 10743
  },
  "positive_rate": {
    "train": 0.2070993361423505,
    "cal": 0.1619383903567515,
    "test": 0.2176300847063204
  },
  "metrics_test": {
    "AUC-PR": 0.4703169148696752,
    "AUC-ROC": 0.7687342405356704,
    "Brier": 0.1531012235296931,
    "LogLoss": 0.470173587724506,
    "F1": 0.49375396993436377,
    "Precision": 0.4888888888888889,
    "Recall": 0.49871685201026517,
    "MCC": 0.3511650732354415,
    "Kappa": 0.35113650770940075,
    "Precision@Recall>=0.80": 0.36243949661181024,
    "Precision@Recall>=0.85": 0.3334451526333445,
    "Precision@Recall>=0.90": 0.29370726942932884,
    "Precision@Recall>=0.95": 0.25946638704415703
  },
  "ci_test": {
    "AUC-PR": {
      "mean": 0.47147069767232846,
      "low": 0.4513211075260862,
      "high": 0.49576431838656987
    },
    "AUC-ROC": {
      "mean": 0.7684674383916059,
      "low": 0.7577754220259041,
      "high": 0.7795718770864578
    },
    "Brier": {
      "mean": 0.15326591934070455,
      "low": 0.14831991015047175,
      "high": 0.158424464772575
    }
  },
  "search_results": [
    {
      "H": 15,
      "T": 1,
      "ap_mean": 0.16416064896936355,
      "ap_std": 0.0308475797568476,
      "brier_mean": 0.17326442995704913,
      "n": 32989
    },
    {
      "H": 15,
      "T": 2,
      "ap_mean": 0.2774604780430455,
      "ap_std": 0.04501342455022635,
      "brier_mean": 0.18469014135969414,
      "n": 32989
    },
    {
      "H": 15,
      "T": 3,
      "ap_mean": 0.36283450011734386,
      "ap_std": 0.05197810815971709,
      "brier_mean": 0.19340585899235566,
      "n": 32989
    },
    {
      "H": 15,
      "T": 4,
      "ap_mean": 0.41214137842081966,
      "ap_std": 0.059729477361094234,
      "brier_mean": 0.20466775031504253,
      "n": 32989
    },
    {
      "H": 15,
      "T": 5,
      "ap_mean": 0.4535541073170855,
      "ap_std": 0.06298686356589807,
      "brier_mean": 0.2126807051147535,
      "n": 32989
    }
  ],
  "feature_cols": [
    "time_in_distraction",
    "time_since_distraction_end",
    "within_distraction",
    "hangover_decay",
    "model_prob",
    "model_prob_slope_decay",
    "model_pred_enc",
    "emotion_prob",
    "emotion_prob_slope_decay",
    "emotion_label_enc",
    "arousal",
    "arousal_delta_baseline",
    "arousal_slope_decay",
    "hr_bpm",
    "hr_delta_baseline",
    "hr_delta_sq",
    "hr_slope_decay",
    "time_since_hr_peak",
    "time_since_arousal_peak",
    "hr_frac_recovery",
    "arousal_frac_recovery",
    "time_since_last_error",
    "dist_density_30",
    "dist_density_60",
    "dist_density_120",
    "sensor_missing_flag",
    "baseline_error_rate",
    "model_prob_ema15",
    "emotion_prob_ema15",
    "arousal_ema15",
    "hr_bpm_ema15",
    "model_prob_dev_ema15",
    "emotion_prob_dev_ema15",
    "arousal_dev_ema15",
    "hr_bpm_dev_ema15",
    "model_prob_diff1_abs",
    "emotion_prob_diff1_abs",
    "arousal_diff1_abs",
    "hr_bpm_diff1_abs",
    "model_prob_roll_std15",
    "emotion_prob_roll_std15",
    "arousal_roll_std15",
    "hr_bpm_roll_std15",
    "model_prob_roll_range15",
    "emotion_prob_roll_range15",
    "arousal_roll_range15",
    "hr_bpm_roll_range15",
    "state_energy",
    "state_imbalance",
    "model_emotion_gap_abs",
    "model_emotion_product",
    "arousal_hr_coupling",
    "model_arousal_coupling",
    "emotion_hr_coupling",
    "model_prob_drawdown",
    "emotion_prob_drawdown",
    "arousal_drawdown",
    "hr_drawdown",
    "signal_diff_abs_energy",
    "signal_roll_std_energy"
  ]
}